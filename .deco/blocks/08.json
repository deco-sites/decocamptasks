{"__resolveType":"site/loaders/ContentLoad.ts","content":{"links":[{"bulletPoints":[],"url":"https://drive.google.com/file/d/1cJO9ru5vQviAPrmKyVFq8zK0u0saXz1_/view?usp=drive_link","description":"Vídeo - 08 - Mastering Loaders: Connecting your Site to the Web"},{"bulletPoints":[],"url":"https://drive.google.com/file/d/18Jcng2XlCik8vdMgJDssMRNTPvnVNgDJ/view?usp=drive_link","description":"Live Coding"}],"topics":["Loaders","Fetch","Load Data"],"title":"08 - Mastering Loaders: Connecting your Site to the Web","publishDate":"2024-05-22","content":"<p>Para o decocamp, implementamos uma API própria com as rotas descritas abaixo.</p><p></p><h2>API Eventos decocamp</h2><p></p><h3>Registro de comentário em um produto</h3><ul><li><p>POST <a target=\"_blank\" rel=\"noopener noreferrer nofollow\" href=\"https://camp-api.deco.cx/event\">https://camp-api.deco.cx/event</a></p></li></ul><p></p><p>Registro de um evento em um produto.</p><pre><code>body: { \"productId\": \"productId\", \"Content\": \"Content\" }\nheader: x-api-key: siteId</code></pre><p></p><p>Chamada curl associada:</p><pre><code>curl --location 'https://camp-api.deco.cx/event' \\\n--header 'x-api-key: teste123' \\\n--header 'Content-Type: application/json' \\\n--data '{ \"productId\": \"productId\", \"comment\": \"comment\" }'</code></pre><p></p><p>Retorno:</p><pre><code>{\n    \"total\": 1, \"product\": 1\n}</code></pre><p></p><h3>Recupera o número de eventos e comentários de um produto</h3><ul><li><p>GET <a target=\"_blank\" rel=\"noopener noreferrer nofollow\" href=\"https://camp-api.deco.cx/event/:productId\">https://camp-api.deco.cx/event/:productId</a></p></li></ul><p></p><p>Recuperar votos de um produto. Chamada curl associada:</p><pre><code>curl --location 'https://camp-api.deco.cx/event/:productId' \\\n--header 'x-api-key: teste123'</code></pre><p></p><p>Retorno:</p><pre><code>{\n    \"product\": 1,\n    \"comments\": [\"comment\"]\n}</code></pre><p></p><h3>Total de eventos no sistema</h3><ul><li><p>GET <a target=\"_blank\" rel=\"noopener noreferrer nofollow\" href=\"https://camp-api.deco.cx/events\">https://camp-api.deco.cx/events</a></p></li></ul><p></p><p>Recuperar o total de votos dados em um site. Chamada curl associada:</p><pre><code>curl --location 'https://camp-api.deco.cx/events' \\\n--header 'x-api-key: teste123'</code></pre><p></p><p>Retorno:</p><pre><code>{\n    \"total\": 1\n}</code></pre><p></p><h2>Incrementando ProductAd</h2><p>Agora, o ProductAd deve também receber a propriedade de Id do produto (ou o product, no tipo ProductDetailsPage, caso esteja usando a API de ecommerce).</p><p></p><p>Além disso, adicione a propriedade:</p><ul><li><p>highlight?: boolean</p></li></ul><p></p><p>Quando o produto tiver mais do que 3 comentários, e a propriedade highlight for verdadeira, coloque uma marcação de destaque no produto. Para tanto, use um loader em si, ou um inline loader (uma função loader no próprio arquivo da section), para consultar se o produto deve receber, ou não, destaque.</p><p></p><p><img src=\"https://ozksgdmyrqcxcwhnbepg.supabase.co/storage/v1/object/public/assets/9261/92cb1e43-2f5e-4480-84ef-515a07242329\"></p><h2>Estatísticas de uso</h2><p></p><p>Lembra do ícone de amigos no header? Ele será um link para uma página /stats que terá duas sections:</p><ul><li><p>a section TotalEvents.tsx, descrevendo o total de saves na página e que recebe um loader de eventos salvos no sistema</p></li><li><p>a section ShowProductEvents.tsx que receberá um productId como input e exibirá o total de votos. O total de votos deve aparecer enquanto o usuário digita o productId (podendo ser zero, caso o produto não exista).</p><ul><li><p>Trabalhar com input enquanto o usuário digita pode levar a fazer consultas inúteis, evite consultas repetidas ao sistema (usando o debounce, verificando se houve alteração de fato no input, etc.)</p></li></ul></li></ul><p></p><p>Veja os protótipos a seguir.</p><p></p><p><img src=\"https://ozksgdmyrqcxcwhnbepg.supabase.co/storage/v1/object/public/assets/9261/72d52884-af20-4e07-ba49-de76f678217a\"></p><h2>Importante!</h2><p></p><ul><li><p>Use nome do seu projeto (ou repositório) como x-api-token</p></li><li><p>Os dados dessa API são apagados de tempos em tempos</p></li></ul>"}}